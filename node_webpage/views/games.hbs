<h1>Games</h1>

<table>
  <thead>
    <tr>
      <th>ID</th>
      <th>Name</th>
      <th>Genre</th>
      <th>Platform</th>
      <th>Users</th>
      <th>Rating</th>
      <th>Description</th>
      <th>Actions</th>
    </tr>
  </thead>
  <tbody>
    {{#each games}}
    <tr>
      <td>{{gameID}}</td>
      <td>{{name}}</td>
      <td>{{genre}}</td>
      <td>{{platform}}</td>
      <td>{{numUsers}}</td>
      <td>{{rating}}</td>
      <td>{{description}}</td>
      <td>
        <form action="/delete-game" method="POST">
          <input type="hidden" name="gameID" value="{{gameID}}" />
          <button type="submit">Delete</button>
        </form>
      </td>
    </tr>
    {{/each}}
  </tbody>
</table>


<h1>Add Game</h1>
<form action="/add-game" method="POST" id="addGameForm">
  <div class="formGroup">

    <div class="formTitle">
      <label for="name">Game Name</label>
      <input type="text" id="name" name="name" required>
    </div>
    <div class="formTitle">
      <label for="addGenreID">Genre ID</label>
      <select id="addGenreID" name="genreID" required></select>
    </div>

    <div class="formTitle">
      <label for="addPlatformID">Platform ID</label>
      <select id="addPlatformID" name="platformID" required></select>
    </div>
  </div>

  <div class="formGroup">
    <div class="formTitle">
      <label for="numUsers">Number of Users</label>
      <input type="number" id="numUsers" name="numUsers" min="0" required>
    </div>

    <div class="formTitle">
      <label for="rating">Rating (1â€“10)</label>
      <input type="number" id="rating" name="rating" min="1" max="10" required>
    </div>

    <div class="formTitle">
      <label for="description">Description</label>
      <input id="description" name="description" required></input>
    </div>

  </div>
  <button type="submit" class="formGroup">Add Game</button>

</form>

<h1>Update Game</h1>
<form action="/edit-game" method="POST">
  
  <label for="name">Game Name</label>
  <select id="gameSelect" name="name" required>
  <option value="">Select a game</option>
  {{#each games}}
    <option value="{{name}}">{{name}}</option>
  {{/each}}
  </select>

  <label for="updateGenreID">Genre ID</label>
  <select id="updateGenreID" name="genreID" required></select>

  <label for="updatePlatformID">Platform ID</label>
  <select id="updatePlatformID" name="platformID" required></select>

  <label for="numUsers">Number of Users</label>
  <input type="number" id="numUsers" name="numUsers" value="0" required>

  <label for="rating">Rating</label>
  <input type="number" id="rating" name="rating" value="10" min="1" max="10" required>

  <label for="description">Description</label>
  <input id="description" name="description" rows="4" required></input>

  <button type="submit">Update Game</button>
</form>
<script>  
  fetch('/get-platforms')
    .then(res => res.json())
    .then(data => {
      const addSelect = document.getElementById('addPlatformID');
      const updateSelect = document.getElementById('updatePlatformID');
      data.forEach(platform => {
        if (platform && platform.platformID && platform.platform) {
          const option1 = document.createElement('option');
          option1.value = platform.platformID;
          option1.textContent = platform.platform;
          addSelect.appendChild(option1);

          const option2 = option1.cloneNode(true);
          updateSelect.appendChild(option2);
        }
      });
    });
  fetch('/get-genres')
    .then(res => res.json())
    .then(data => {
      const addSelect = document.getElementById('addGenreID');
      const updateSelect = document.getElementById('updateGenreID');
      data.forEach(genre => {
        if (genre && genre.genreID && genre.name) {
          const option1 = document.createElement('option');
          option1.value = genre.genreID;
          option1.textContent = genre.name;
          addSelect.appendChild(option1);

          const option2 = option1.cloneNode(true);
          updateSelect.appendChild(option2);
        }
      });
    });
</script>